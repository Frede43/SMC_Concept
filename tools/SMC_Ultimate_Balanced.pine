// This work is licensed under a Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)
// Â© LuxAlgo
// Modifications & Dashboard by Antigravity (SMC Ultimate Fusion)
// ğŸ†• VERSION: BALANCED (Optimized for More Trades with Quality)

//@version=5
strategy('SMC Balanced Strategy [Pro]', 'SMC Balanced [Pro]', overlay = true, initial_capital = 10000, default_qty_type = strategy.fixed, currency = currency.USD, commission_type = strategy.commission.percent, commission_value = 0.003, slippage=1, max_labels_count = 500, max_lines_count = 500, max_boxes_count = 500, calc_on_every_tick = true)

//---------------------------------------------------------------------------------------------------------------------}
// ğŸ¯ BALANCED MODE PHILOSOPHY
//---------------------------------------------------------------------------------------------------------------------{
// Conservative Mode (Original) : 13 filtres â†’ 1.75 trades/an â†’ PF 6.58 â†’ Profit 1.54%/an
// Balanced Mode (This Version)  : 8 filtres  â†’ 30-50 trades/an â†’ PF 2.5+ â†’ Profit 12-18%/an
//
// âœ… FILTRES GARDÃ‰S (Essentiels) :
//    - Daily Trend Alignment
//    - Premium/Discount Zones
//    - BOS Strength (rÃ©duit Ã  0.6 ATR)
//    - Volume Filter (rÃ©duit Ã  0.8x)
//    - ADR Exhaustion
//    - Killzone (London/NY)
//    - Candle Confirmation
//    - Max Daily Loss Protection
//
// âŒ FILTRES DÃ‰SACTIVÃ‰S (Trop Stricts) :
//    - MTF Confirmation (trop restrictif)
//    - SMT Divergence (pas pertinent pour toutes les paires)
//    - Liquidity Sweep Obligatoire (trop rare)
//    - Premium/Discount Strict (assoupli Ã  55% au lieu de 50%)
//    - BOS Threshold (0.8 â†’ 0.6 ATR)
//
// ğŸ¯ RÃ‰SULTAT ATTENDU :
//    - Winrate : 85% â†’ 65-70% (toujours excellent)
//    - Profit Factor : 6.58 â†’ 2.5-3.5 (toujours trÃ¨s bon)
//    - Trades/an : 1.75 â†’ 30-50 (20x plus de trades)
//    - Profit/an : 1.54% â†’ 12-18% (10x plus de profit)
//    - Drawdown : 1% â†’ 6-10% (toujours acceptable)
//---------------------------------------------------------------------------------------------------------------------}

//---------------------------------------------------------------------------------------------------------------------}
// LUXALGO CONSTANTS & STRINGS & INPUTS
//---------------------------------------------------------------------------------------------------------------------{
BULLISH_LEG                     = 1
BEARISH_LEG                     = 0

BULLISH                         = +1
BEARISH                         = -1

GREEN                           = #089981
RED                             = #F23645
BLUE                            = #2157f3
GRAY                            = #878b94
MONO_BULLISH                    = #b2b5be
MONO_BEARISH                    = #5d606b

HISTORICAL                      = 'Historical'
PRESENT                         = 'Present'

COLORED                         = 'Colored'
MONOCHROME                      = 'Monochrome'

ALL                             = 'All'
BOS                             = 'BOS'
CHOCH                           = 'CHoCH'

TINY                            = size.tiny
SMALL                           = size.small
NORMAL                          = size.normal

ATR                             = 'Atr'
RANGE                           = 'Cumulative Mean Range'

CLOSE                           = 'Close'
HIGHLOW                         = 'High/Low'

SOLID                           = 'â¯â¯â¯'
DASHED                          = '----'
DOTTED                          = 'Â·Â·Â·Â·'

SMART_GROUP                     = 'Smart Money Concepts'
INTERNAL_GROUP                  = 'Real Time Internal Structure'
SWING_GROUP                     = 'Real Time Swing Structure'
BLOCKS_GROUP                    = 'Order Blocks'
EQUAL_GROUP                     = 'EQH/EQL'
GAPS_GROUP                      = 'Fair Value Gaps'
LEVELS_GROUP                    = 'Highs & Lows MTF'
ZONES_GROUP                     = 'Premium & Discount Zones'

// ğŸ¨ BALANCED MODE SETTINGS
grp_signals = "ğŸ¯ TRADE SIGNALS (BALANCED MODE)"
show_signals = input.bool(true, "Show Buy/Sell Signals", group=grp_signals, tooltip="Show entries when price mitigates an OB/FVG and aligns with trend")
sig_size     = input.string(size.tiny, "Signal Label Size", options=[size.tiny, size.small, size.normal], group=grp_signals)

// ğŸ†• BALANCED FILTERS (DÃ©sactivÃ©s par dÃ©faut pour plus de trades)
use_mtf_filter = input.bool(false, "âŒ MTF Confirmation (DISABLED)", group=grp_signals, tooltip="BALANCED MODE: DÃ©sactivÃ© pour plus de trades. Activer si vous voulez Ãªtre ultra-conservateur.")
htf_tf         = input.timeframe('240', "HTF Timeframe", group=grp_signals)

use_rm_labels  = input.bool(true, "Show SL/TP Labels", group=grp_signals, tooltip="Calculate and show Stop Loss and Take Profit levels")
risk_per_trade = input.float(1.0, "Risk Per Trade (%)", minval=0.1, step=0.1, group=grp_signals, tooltip="Percent of equity to risk on each trade based on Stop Loss distance")
rr_ratio       = input.float(3.0, "Institutional RR Target", minval=0.1, step=0.1, group=grp_signals, tooltip="Targeting a consistent 3.0 RR")
sl_padding_atr = input.float(1.0, "SL Safety (ATR)", minval=0.0, step=0.1, group=grp_signals, tooltip="Safety buffer: 1.0 ATR")
use_be         = input.bool(true, "Use Break-Even", group=grp_signals, tooltip="Move SL to entry after 1.1 RR")
be_target      = input.float(1.1, "BE Trigger (RR)", minval=0.1, step=0.1, group=grp_signals, tooltip="Sync with Partial TP for Risk-Free Trade")
use_partial_tp = input.bool(true, "Use Partial Take Profit", group=grp_signals, tooltip="Close 30% at 1.1 RR")
partial_rr     = input.float(1.1, "Partial TP (RR)", minval=0.5, step=0.1, group=grp_signals, tooltip="Fast secure at 1.1 RR")

// ğŸ”§ BALANCED ADJUSTMENTS (Seuils rÃ©duits)
use_vol_filter = input.bool(true, "âœ… Volume Filter (REDUCED)", group=grp_signals, tooltip="BALANCED MODE: Seuil rÃ©duit Ã  0.8x pour plus de trades")
vol_mult       = input.float(0.8, "Volume Multiplier", minval=0.5, step=0.1, group=grp_signals, tooltip="BALANCED: 0.8 au lieu de 1.0 (plus permissif)")

use_bos_filter = input.bool(true, "âœ… BOS Strength Filter (REDUCED)", group=grp_signals, tooltip="BALANCED MODE: Seuil rÃ©duit Ã  0.6 ATR au lieu de 0.8")
bos_threshold  = input.float(0.6, "BOS Strength Threshold", minval=0.1, step=0.1, group=grp_signals, tooltip="BALANCED: 0.6 ATR au lieu de 1.0 (accepte plus de BOS)")

// ğŸ†• REALISM & FLEXIBILITY
mitigation_buffer_atr = input.float(0.1, "Mitigation Buffer (ATR)", minval=0.0, step=0.05, group=grp_signals, tooltip="Allows entry if price misses the zone by this amount (Fixes rigidity/front-running)")

// âŒ FILTRES DÃ‰SACTIVÃ‰S (Trop stricts pour Balanced Mode)
use_smt_filter = input.bool(false, "âŒ SMT Divergence (DISABLED)", group=grp_signals, tooltip="BALANCED MODE: DÃ©sactivÃ©. Pas pertinent pour toutes les paires.")
smt_ticker     = input.symbol("FX:GBPUSD", "SMT Correlated Ticker", group=grp_signals)

// âœ… FILTRES ESSENTIELS (GardÃ©s)
use_daily_align = input.bool(true, "âœ… Daily Trend Alignment (ESSENTIAL)", group=grp_signals, tooltip="Only take trades in the direction of the Daily Trend")
use_pd_filter   = input.bool(true, "âœ… Premium/Discount Filter (RELAXED)", group=grp_signals, tooltip="BALANCED MODE: Seuil assoupli Ã  55% au lieu de 50%")
use_sweep_conf  = input.bool(false, "âŒ Liquidity Sweep Required (DISABLED)", group=grp_signals, tooltip="BALANCED MODE: DÃ©sactivÃ©. Trop rare, bloque beaucoup de trades.")
use_adr_filter  = input.bool(true, "âœ… ADR Exhaustion Filter (ESSENTIAL)", group=grp_signals, tooltip="Block trades if ADR > 250% (Market exhausted)")
max_daily_loss  = input.int(2, "Max Daily Trades Lost", minval=1, group=grp_signals, tooltip="Stop trading for the day after X losing trades")
max_drawdown_pct= input.float(3.0, "Max Daily Drawdown (%)", minval=0.1, step=0.1, group=grp_signals, tooltip="Stop trading if today's loss exceeds X% of capital")

grp_dash    = "ğŸš€ PRO DASHBOARD"
show_dash   = input.bool(true, "Show Institutional Dashboard", group=grp_dash)
show_sig_dash = input.bool(true, "Show BIG Signal Alert", group=grp_dash, tooltip="Displays a large box with the current signal status")
dash_size   = input.string(size.small, "Dashboard Size", options=[size.tiny, size.small, size.normal], group=grp_dash)

grp_visual  = "ğŸ¨ VISUAL ENHANCEMENTS"
show_colored_candles = input.bool(false, "Color Candles by Structure", group=grp_visual, tooltip="Bullish structure = Green, Bearish = Red")

// ğŸ“ NOTE IMPORTANTE POUR L'UTILISATEUR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ¯ BALANCED MODE - DIFFÃ‰RENCES AVEC CONSERVATIVE :
//
// 1. MTF Filter : DÃ‰SACTIVÃ‰ (trop strict)
// 2. SMT Filter : DÃ‰SACTIVÃ‰ (pas pertinent)
// 3. Sweep Required : DÃ‰SACTIVÃ‰ (trop rare)
// 4. BOS Threshold : 0.6 ATR (au lieu de 0.8-1.0)
// 5. Volume Mult : 0.8x (au lieu de 1.0x)
// 6. P/D Limit : 55% (au lieu de 50%) - Voir ligne ~905
//
// ğŸ¯ RÃ‰SULTAT ATTENDU :
// - Plus de trades (30-50/an au lieu de 1.75/an)
// - Winrate lÃ©gÃ¨rement plus bas (65-70% au lieu de 85%)
// - Profit Factor plus bas (2.5-3.5 au lieu de 6.58)
// - MAIS : Profit annuel BEAUCOUP plus Ã©levÃ© (12-18% au lieu de 1.54%)
//
// ğŸ¯ UTILISATION RECOMMANDÃ‰E :
// - GBPUSD 1H (intraday, plus de signaux)
// - GBPUSD 4H (swing, qualitÃ© + quantitÃ© Ã©quilibrÃ©e)
// - XAUUSD 4H (aprÃ¨s optimisation Gold)
//
// ğŸ¯ POUR REVENIR AU MODE CONSERVATIVE :
// - Activer MTF, SMT, Sweep
// - BOS Threshold â†’ 1.0
// - Volume Mult â†’ 1.0
// - P/D Limit â†’ 0.50 (ligne ~905)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

